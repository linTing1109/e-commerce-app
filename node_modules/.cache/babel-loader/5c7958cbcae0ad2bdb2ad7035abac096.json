{"ast":null,"code":"var _jsxFileName = \"C:\\\\JavaPCSchool3\\\\e-commerce-app\\\\src\\\\Homework\\\\MemberLogic.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport Modal from 'react-modal'; //有多import才可以使用\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst apiUrl = 'http://localhost:8090/training/ecommerce/MemberController/login';\n\n// 功能:會員登入頁面\nconst MemberLogic = _ref => {\n  _s();\n  let {\n    isLoginData\n  } = _ref;\n  const [isLoading, setIsLoading] = useState(false);\n\n  // const [carCount]=props;\n\n  const navigate = useNavigate();\n  const inputPdRef = useRef();\n  const [showModal, setShowModal] = useState(false);\n  const [data, setData] = useState({\n    // 後端api傳入使用:memberInfoVo傳api 把identificationNo&cusPassword包進去\n    memberInfoVo: {\n      identificationNo: '',\n      cusPassword: ''\n    },\n    //回傳所需的資料 密碼不會秀出來 所以這邊不會有密碼\n    idNo: '',\n    cusName: '',\n    isLogin: false,\n    loginMessage: ''\n  });\n\n  // 解構 \n  const {\n    memberInfoVo,\n    idNo,\n    cusName,\n    isLogin,\n    loginMessage\n  } = data;\n  const {\n    identificationNo,\n    cusPassword\n  } = memberInfoVo;\n  const changeMemberID = event => {\n    setData(prevState => ({\n      ...prevState,\n      memberInfoVo: {\n        //兩層式的寫法\n        ...prevState.memberInfoVo,\n        identificationNo: event.target.value\n        // loginMessage:''\n      }\n    }));\n\n    inputPdRef.current.focus(); //當滑鼠點擊其他地方時 游標跳到password那邊\n  };\n\n  const changePassword = event => {\n    setData(prevState => ({\n      ...prevState,\n      memberInfoVo: {\n        ...prevState.memberInfoVo,\n        cusPassword: event.target.value\n        // loginMessage:'',\n      }\n    }));\n  };\n\n  // 點擊登入按鈕  \n  const clickMemberLogic = () => {\n    fetchList();\n    //代表已經登入 導入商品頁\n    if (cusName != null) {\n      setIsLoading(true);\n      window.location = \"/SearchGoods\"; //為了上半部重新刷新 所以故意使用這個\n    }\n\n    // 尚未登入 秀出彈跳畫面視窗(錯誤結果)\n    if (cusName == null) {\n      setShowModal(true);\n    }\n  };\n\n  // 後端api\n  const fetchList = async () => {\n    const memberData = await axios.post(apiUrl, memberInfoVo, {\n      withCredentials: true\n    }).then(rs => rs.data).catch(error => {\n      console.log(error);\n    });\n    setData(e => ({\n      ...e,\n      //hooks無法部分更新,加...e為保持原先欄位\n      idNo: memberData.identificationNo,\n      //這邊不會有密碼出現\n      cusName: memberData.cusName,\n      loginMessage: memberData.loginMessage,\n      isLogin: memberData.isLogin\n    }));\n  };\n  useEffect(() => {\n    if (isLoginData) {\n      //當頁面已經登入又回到登入頁面時 自動帶入到商品頁面中\n      navigate('/SearchGoods');\n    }\n  }, [isLoginData]); //當輸入帳號密碼更新 \n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [\"\\u6E2C\\u8A66:\", isLogin.toString(), \"\\u6703\\u54E1\\u767B\\u5165\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 17\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }, this), \"\\u6703\\u54E1\\u5E33\\u865F ID\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 22\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      name: \"id\",\n      placeholder: \"Enter ID\",\n      required: true,\n      onBlur: changeMemberID\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 15\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 103\n    }, this), \"\\u6703\\u54E1\\u5BC6\\u78BC Password\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 28\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"password\",\n      name: \"pwd\",\n      placeholder: \"Enter Password\",\n      required: true,\n      onBlur: changePassword,\n      ref: inputPdRef\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 15\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 129\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: clickMemberLogic,\n      children: \"\\u767B\\u5165\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 15\n    }, this), isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"overlay\",\n      children: [loginMessage, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 23\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 28\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 33\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 38\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 43\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 19\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: showModal,\n      onRequestClose: () => setShowModal(false),\n      style: {\n        content: {\n          width: '400px',\n          // 設定寬度\n          height: '300px' // 設定高度\n        }\n      },\n      children: [loginMessage, /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowModal(false),\n        children: \"\\u95DC\\u9589\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 15\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 9\n  }, this);\n};\n_s(MemberLogic, \"iUaFP3P6HwK4SRHdneNzJYy+T48=\", false, function () {\n  return [useNavigate];\n});\n_c = MemberLogic;\nexport default MemberLogic;\nvar _c;\n$RefreshReg$(_c, \"MemberLogic\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","axios","Modal","apiUrl","MemberLogic","isLoginData","isLoading","setIsLoading","navigate","inputPdRef","showModal","setShowModal","data","setData","memberInfoVo","identificationNo","cusPassword","idNo","cusName","isLogin","loginMessage","changeMemberID","event","prevState","target","value","current","focus","changePassword","clickMemberLogic","fetchList","window","location","memberData","post","withCredentials","then","rs","catch","error","console","log","e","toString","content","width","height"],"sources":["C:/JavaPCSchool3/e-commerce-app/src/Homework/MemberLogic.js"],"sourcesContent":["import React, { useState,useRef ,useEffect} from 'react';\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport Modal from 'react-modal';//有多import才可以使用\r\n\r\nconst apiUrl = 'http://localhost:8090/training/ecommerce/MemberController/login';\r\n\r\n// 功能:會員登入頁面\r\nconst MemberLogic = ({isLoginData}) => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  // const [carCount]=props;\r\n\r\n  const navigate = useNavigate();\r\n  const inputPdRef = useRef();\r\n\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [data, setData] = useState({\r\n\r\n        // 後端api傳入使用:memberInfoVo傳api 把identificationNo&cusPassword包進去\r\n        memberInfoVo:{ \r\n            identificationNo: '',\r\n            cusPassword: '',\r\n        },\r\n\r\n        //回傳所需的資料 密碼不會秀出來 所以這邊不會有密碼\r\n        idNo: '',\r\n        cusName: '',\r\n        isLogin:false,\r\n        loginMessage:'',\r\n    });\r\n\r\n    // 解構 \r\n    const {memberInfoVo,idNo,cusName,isLogin,loginMessage} =data ;\r\n    const {identificationNo,cusPassword}=memberInfoVo;\r\n    \r\n\r\n    const changeMemberID = (event) => {\r\n        setData((prevState) => ({\r\n          ...prevState,\r\n          memberInfoVo: { //兩層式的寫法\r\n            ...prevState.memberInfoVo,\r\n            identificationNo: event.target.value,\r\n            // loginMessage:''\r\n          },\r\n        }));\r\n        inputPdRef.current.focus(); //當滑鼠點擊其他地方時 游標跳到password那邊\r\n      };  \r\n      \r\n      const changePassword = (event) => {\r\n        setData((prevState) => ({\r\n          ...prevState,\r\n          memberInfoVo: {\r\n            ...prevState.memberInfoVo,\r\n            cusPassword: event.target.value,\r\n            // loginMessage:'',\r\n          },\r\n        }));\r\n      };  \r\n    \r\n    // 點擊登入按鈕  \r\n    const clickMemberLogic = ()  => {\r\n        fetchList();\r\n        //代表已經登入 導入商品頁\r\n        if(cusName != null){ \r\n          setIsLoading(true);\r\n          window.location = \"/SearchGoods\";//為了上半部重新刷新 所以故意使用這個\r\n        }\r\n\r\n        // 尚未登入 秀出彈跳畫面視窗(錯誤結果)\r\n        if (cusName == null ) {\r\n          setShowModal(true);\r\n        }\r\n       \r\n    }\r\n\r\n    // 後端api\r\n    const fetchList = async() => {\r\n        const memberData = await axios.post(apiUrl, memberInfoVo,{ withCredentials: true })\r\n            .then(rs => rs.data)\r\n            .catch(error => { console.log(error); });\r\n            setData( e => ({\r\n                    ...e,//hooks無法部分更新,加...e為保持原先欄位\r\n                    idNo: memberData.identificationNo,  //這邊不會有密碼出現\r\n                    cusName: memberData.cusName,\r\n                    loginMessage: memberData.loginMessage,\r\n                    isLogin: memberData.isLogin,\r\n                }));\r\n                \r\n    \r\n    };\r\n\r\n    useEffect(() => {\r\n      if (isLoginData) { //當頁面已經登入又回到登入頁面時 自動帶入到商品頁面中\r\n        navigate('/SearchGoods');\r\n      }\r\n      \r\n\r\n    },[isLoginData]);//當輸入帳號密碼更新 \r\n\r\n    return (\r\n        <div>\r\n          測試:{isLogin.toString()}\r\n\r\n\r\n            會員登入<br />\r\n            <br />\r\n              會員帳號 ID<br /> \r\n              {/* 使用 onBlur 避免頻繁被觸發 */}\r\n              <input type=\"text\" name=\"id\" placeholder=\"Enter ID\" required  onBlur={changeMemberID} /><br />\r\n              會員密碼 Password<br />\r\n              <input type=\"password\" name=\"pwd\" placeholder=\"Enter Password\" required onBlur={changePassword} ref={inputPdRef}/><br />\r\n              \r\n              <button onClick={clickMemberLogic}>登入</button>\r\n            \r\n            {/* {!isLogin && <div>{loginMessage}</div>} */}\r\n\r\n            {/* <Model>{loginMessage}</Model> */}\r\n            {isLoading && (\r\n                  <div className=\"overlay\">\r\n                    {loginMessage}\r\n                      {/* <img src={loadingWait} style={{ width: '300px', height: '300px' }} /><br/> */}\r\n                      <br/><br/><br/><br/><br/>\r\n                      {/* <div>加入購物車中...</div> */}\r\n                      {/* <div className=\"overlay\">加入購物車中...</div> */}\r\n                      {/* 加入購物車... */}\r\n                  </div>\r\n            )}\r\n\r\n            <Modal\r\n              isOpen={showModal}\r\n              onRequestClose={() => setShowModal(false)}\r\n              style={{\r\n                content: {\r\n                  width: '400px',  // 設定寬度\r\n                  height: '300px', // 設定高度\r\n                },\r\n              }}\r\n            >\r\n              {loginMessage}\r\n              <button onClick={() => setShowModal(false)}>關閉</button>\r\n            </Modal>\r\n            \r\n            {/* <Modal\r\n                isOpen={showModal}\r\n                onRequestClose={handleCloseModal}\r\n                overlayClassName=\"modal-overlay\"\r\n                className=\"modal-content\"\r\n              >\r\n                <h2>彈跳視窗</h2>\r\n                <p>點擊任意地方以關閉視窗</p>\r\n            </Modal> */}\r\n            <hr/>\r\n            \r\n            {/* 測試用:<br/>\r\n            idNo:{idNo}<br/>\r\n            cusName:{cusName}<br/> */}\r\n            {/* JSX 不能直接顯示布林值 要先轉換成String才可以直接秀出來 */}\r\n            {/* isLogin: {String(isLogin)}<br/> \r\n            loginMessage:{loginMessage}<br/> */}\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MemberLogic\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAACC,MAAM,EAAEC,SAAS,QAAO,OAAO;AACxD,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,MAAM,aAAa,CAAC;AAAA;AAEhC,MAAMC,MAAM,GAAG,iEAAiE;;AAEhF;AACA,MAAMC,WAAW,GAAG,QAAmB;EAAA;EAAA,IAAlB;IAACC;EAAW,CAAC;EAChC,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGV,QAAQ,CAAC,KAAK,CAAC;;EAEjD;;EAEA,MAAMW,QAAQ,GAAGR,WAAW,EAAE;EAC9B,MAAMS,UAAU,GAAGX,MAAM,EAAE;EAE3B,MAAM,CAACY,SAAS,EAAEC,YAAY,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACe,IAAI,EAAEC,OAAO,CAAC,GAAGhB,QAAQ,CAAC;IAE3B;IACAiB,YAAY,EAAC;MACTC,gBAAgB,EAAE,EAAE;MACpBC,WAAW,EAAE;IACjB,CAAC;IAED;IACAC,IAAI,EAAE,EAAE;IACRC,OAAO,EAAE,EAAE;IACXC,OAAO,EAAC,KAAK;IACbC,YAAY,EAAC;EACjB,CAAC,CAAC;;EAEF;EACA,MAAM;IAACN,YAAY;IAACG,IAAI;IAACC,OAAO;IAACC,OAAO;IAACC;EAAY,CAAC,GAAER,IAAI;EAC5D,MAAM;IAACG,gBAAgB;IAACC;EAAW,CAAC,GAACF,YAAY;EAGjD,MAAMO,cAAc,GAAIC,KAAK,IAAK;IAC9BT,OAAO,CAAEU,SAAS,KAAM;MACtB,GAAGA,SAAS;MACZT,YAAY,EAAE;QAAE;QACd,GAAGS,SAAS,CAACT,YAAY;QACzBC,gBAAgB,EAAEO,KAAK,CAACE,MAAM,CAACC;QAC/B;MACF;IACF,CAAC,CAAC,CAAC;;IACHhB,UAAU,CAACiB,OAAO,CAACC,KAAK,EAAE,CAAC,CAAC;EAC9B,CAAC;;EAED,MAAMC,cAAc,GAAIN,KAAK,IAAK;IAChCT,OAAO,CAAEU,SAAS,KAAM;MACtB,GAAGA,SAAS;MACZT,YAAY,EAAE;QACZ,GAAGS,SAAS,CAACT,YAAY;QACzBE,WAAW,EAAEM,KAAK,CAACE,MAAM,CAACC;QAC1B;MACF;IACF,CAAC,CAAC,CAAC;EACL,CAAC;;EAEH;EACA,MAAMI,gBAAgB,GAAG,MAAO;IAC5BC,SAAS,EAAE;IACX;IACA,IAAGZ,OAAO,IAAI,IAAI,EAAC;MACjBX,YAAY,CAAC,IAAI,CAAC;MAClBwB,MAAM,CAACC,QAAQ,GAAG,cAAc,CAAC;IACnC;;IAEA;IACA,IAAId,OAAO,IAAI,IAAI,EAAG;MACpBP,YAAY,CAAC,IAAI,CAAC;IACpB;EAEJ,CAAC;;EAED;EACA,MAAMmB,SAAS,GAAG,YAAW;IACzB,MAAMG,UAAU,GAAG,MAAMhC,KAAK,CAACiC,IAAI,CAAC/B,MAAM,EAAEW,YAAY,EAAC;MAAEqB,eAAe,EAAE;IAAK,CAAC,CAAC,CAC9EC,IAAI,CAACC,EAAE,IAAIA,EAAE,CAACzB,IAAI,CAAC,CACnB0B,KAAK,CAACC,KAAK,IAAI;MAAEC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;IAAE,CAAC,CAAC;IACxC1B,OAAO,CAAE6B,CAAC,KAAK;MACP,GAAGA,CAAC;MAAC;MACLzB,IAAI,EAAEgB,UAAU,CAAClB,gBAAgB;MAAG;MACpCG,OAAO,EAAEe,UAAU,CAACf,OAAO;MAC3BE,YAAY,EAAEa,UAAU,CAACb,YAAY;MACrCD,OAAO,EAAEc,UAAU,CAACd;IACxB,CAAC,CAAC,CAAC;EAGf,CAAC;EAEDpB,SAAS,CAAC,MAAM;IACd,IAAIM,WAAW,EAAE;MAAE;MACjBG,QAAQ,CAAC,cAAc,CAAC;IAC1B;EAGF,CAAC,EAAC,CAACH,WAAW,CAAC,CAAC,CAAC;;EAEjB,oBACI;IAAA,4BACMc,OAAO,CAACwB,QAAQ,EAAE,2CAGhB;MAAA;MAAA;MAAA;IAAA,QAAM,eACV;MAAA;MAAA;MAAA;IAAA,QAAM,8CACG;MAAA;MAAA;MAAA;IAAA,QAAM,eAEb;MAAO,IAAI,EAAC,MAAM;MAAC,IAAI,EAAC,IAAI;MAAC,WAAW,EAAC,UAAU;MAAC,QAAQ;MAAE,MAAM,EAAEtB;IAAe;MAAA;MAAA;MAAA;IAAA,QAAG;MAAA;MAAA;MAAA;IAAA,QAAM,oDACjF;MAAA;MAAA;MAAA;IAAA,QAAM,eACnB;MAAO,IAAI,EAAC,UAAU;MAAC,IAAI,EAAC,KAAK;MAAC,WAAW,EAAC,gBAAgB;MAAC,QAAQ;MAAC,MAAM,EAAEO,cAAe;MAAC,GAAG,EAAEnB;IAAW;MAAA;MAAA;MAAA;IAAA,QAAE;MAAA;MAAA;MAAA;IAAA,QAAM,eAExH;MAAQ,OAAO,EAAEoB,gBAAiB;MAAA;IAAA;MAAA;MAAA;MAAA;IAAA,QAAY,EAK/CvB,SAAS,iBACJ;MAAK,SAAS,EAAC,SAAS;MAAA,WACrBc,YAAY,eAEX;QAAA;QAAA;QAAA;MAAA,QAAK;QAAA;QAAA;QAAA;MAAA,QAAK;QAAA;QAAA;QAAA;MAAA,QAAK;QAAA;QAAA;QAAA;MAAA,QAAK;QAAA;QAAA;QAAA;MAAA,QAAK;IAAA;MAAA;MAAA;MAAA;IAAA,QAKlC,eAED,QAAC,KAAK;MACJ,MAAM,EAAEV,SAAU;MAClB,cAAc,EAAE,MAAMC,YAAY,CAAC,KAAK,CAAE;MAC1C,KAAK,EAAE;QACLiC,OAAO,EAAE;UACPC,KAAK,EAAE,OAAO;UAAG;UACjBC,MAAM,EAAE,OAAO,CAAE;QACnB;MACF,CAAE;MAAA,WAED1B,YAAY,eACb;QAAQ,OAAO,EAAE,MAAMT,YAAY,CAAC,KAAK,CAAE;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QAAY;IAAA;MAAA;MAAA;MAAA;IAAA,QACjD,eAWR;MAAA;MAAA;MAAA;IAAA,QAAK;EAAA;IAAA;IAAA;IAAA;EAAA,QASH;AAEd,CAAC;AAAA,GA3JKP,WAAW;EAAA,QAKEJ,WAAW;AAAA;AAAA,KALxBI,WAAW;AA6JjB,eAAeA,WAAW;AAAA;AAAA"},"metadata":{},"sourceType":"module"}